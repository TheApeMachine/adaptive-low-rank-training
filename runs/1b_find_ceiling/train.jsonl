{"type":"meta","step":0,"env":{"time":"2025-12-18T12:43:04+01:00","python":"3.12.12 (main, Oct  9 2025, 11:07:00) [Clang 17.0.0 (clang-1700.0.13.3)]","platform":"macOS-15.6-arm64-arm-64bit","torch":"2.9.1","device":"mps","triton_available":false},"argv":["v29_transformer_decoupled_bottleneck_instrumented.py","--mode","train","--size","1b","--attn-mode","decoupled","--tie-qk","--no-null-attn","--param-dtype","bf16","--amp","--amp-dtype","bf16","--grad-checkpoint","--optimizer","lion","--lr","1e-4","--lr-schedule","cosine","--warmup-steps","200","--data","fineweb_1b.npy","--data-format","npy","--vocab-size","50257","--steps","50","--eval-every","0","--analysis-every","0","--instrument","basic","--log-every","1","--batch-size","16","--grad-accum","4","--train-seq-len","2048","--opt-foreach","--out-dir=runs/1b_find_ceiling"],"args":{"size":"1b","exp":null,"run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_1b.npy","data_format":"npy","data_dtype":"uint16","vocab_size":50257,"val_frac":0.1,"out_dir":"runs/1b_find_ceiling","seed":1337,"device":null,"compile":false,"compile_mode":"default","amp":true,"amp_dtype":"bf16","param_dtype":"bf16","matmul_precision":"high","layers":18,"d_model":2048,"n_head":16,"d_ff":8192,"block":2048,"embed_dim":2048,"attn_mode":"decoupled","kv_head":null,"attn_dim":512,"sem_dim":32,"geo_dim":64,"no_rope":false,"rope":false,"rope_base":10000.0,"tie_qk":true,"no_tie_qk":false,"null_attn":false,"no_null_attn":true,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":50,"batch_size":16,"grad_accum":4,"train_seq_len":2048,"seq_schedule":null,"eval_seq_len":0,"grad_checkpoint":true,"optimizer":"lion","adam_betas":"0.9,0.95","adam_eps":1e-08,"lion_betas":"0.9,0.99","lr":0.0001,"lr_schedule":"cosine","warmup_steps":200,"min_lr":0.0,"opt_foreach":true,"opt_fused":false,"weight_decay":0.1,"grad_clip":1.0,"save_every":0,"eval_every":0,"eval_iters":20,"log_every":1,"instrument":"basic","analysis_every":0,"analysis_max_tokens":256,"analysis_layers":"0,-1","analysis_heads":"0","analysis_topk":8,"analysis_local_window":32,"analysis_save_scores":false,"live":"auto","live_update_every":1,"sync_timing":false,"live_plot":false,"tb":false,"mode":"train","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","self_opt":"none","self_opt_cache":null,"self_opt_decode_blocks":"256,512,1024,2048","self_opt_block_n":"128","self_opt_warps":"4,8","self_opt_stages":"2,3","self_opt_warmup":1,"self_opt_iters":3,"self_opt_interval":256,"self_opt_hysteresis":0.03,"self_opt_verbose":false,"self_opt_verify":false,"self_opt_verify_tol":0.005,"self_opt_scope":"all","self_opt_residuals":"0,32,64,128","self_opt_qblocks":"16,32,64","self_opt_k_sem_kinds":"q4_0,nf4,q8_0,fp16","self_opt_k_geo_kinds":"q8_0,q4_0,fp16","self_opt_v_kinds":"q4_0,q8_0,fp16","self_opt_mem_budget_mb":null,"self_opt_mem_overhead_frac":0.1,"self_opt_policy_prefix_len":null,"self_opt_policy_warmup":1,"self_opt_policy_iters":3,"self_opt_policy_hysteresis":0.02,"self_opt_prefer_low_mem_within":0.02,"self_opt_policy_quality":false,"self_opt_calib_tokens":null,"self_opt_calib_prefill":128,"self_opt_calib_decode":32,"self_opt_quality_tol":0.5,"self_opt_quality_delta_nll_tol":0.02,"self_opt_quality_ppl_ratio_tol":1.02,"self_opt_quality_kl_tol":null,"self_opt_quality_kl":false,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null,"tokenizer":"word"},"config":{"vocab_size":50257,"block_size":2048,"n_layer":18,"n_head":16,"kv_head":null,"d_model":2048,"d_ff":8192,"embed_dim":2048,"attn_mode":"decoupled","attn_dim":512,"sem_dim":32,"geo_dim":64,"rope":true,"rope_base":10000.0,"tie_qk":true,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-18T12:43:04+01:00"}
{"type":"mem","step":0,"kv_ctx_bytes":44826624,"kv_128k_bytes":2801664000,"data_format":"npy","data_dtype":"uint16","n_tokens_total":1000000000,"n_tokens_train":900000000,"n_tokens_val":100000000,"vocab_size":50257,"wall_time":"2025-12-18T12:43:04+01:00"}
{"type":"train","step":1,"loss":11.246099472045898,"ppl":76580.6315589833,"lr":5e-07,"tok_s":1222.971572589185,"seq_len":2048,"grad_accum":4,"global_batch":64,"step_ms":107175.0177500071,"data_ms":410.87570699164644,"fwd_ms":27938.246542064007,"bwd_ms":77360.2657490992,"opt_ms":1464.3113749916665,"grad_clip_norm":4.15625,"opt_state_bytes":2100671040,"mps_mem_alloc_bytes":39872971264.0,"mps_mem_driver_bytes":92214296576.0,"cpu_rss_bytes":4608458752.0,"grad_norm_embed":0.4684245251162261,"grad_norm_attn":0.6191611702202781,"grad_norm_ffn":0.6209744276582488,"grad_norm_attn_sem":0.11087685685479015,"grad_norm_attn_geo":0.04789541390913343,"grad_norm_total":1.0014883815121973,"wall_time":"2025-12-18T12:44:52+01:00"}
{"type":"train","step":2,"loss":11.242721557617188,"ppl":76322.38515136945,"lr":1e-06,"tok_s":1150.161773184045,"seq_len":2048,"grad_accum":4,"global_batch":64,"step_ms":113959.62120802142,"data_ms":503.64437501411885,"fwd_ms":29919.3987090257,"bwd_ms":82039.47720711585,"opt_ms":1495.4165419912897,"grad_clip_norm":4.28125,"opt_state_bytes":2100671040,"mps_mem_alloc_bytes":13222723840.0,"mps_mem_driver_bytes":92214296576.0,"cpu_rss_bytes":4608458752.0,"grad_norm_embed":0.4678107547408926,"grad_norm_attn":0.6187954034152886,"grad_norm_ffn":0.6237686191772186,"grad_norm_attn_sem":0.10630356099115208,"grad_norm_attn_geo":0.044034865431558476,"grad_norm_total":1.0020386520800295,"wall_time":"2025-12-18T12:46:46+01:00"}
