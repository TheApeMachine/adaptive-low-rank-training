{"type":"meta","step":0,"env":{"python":"3.12.12","torch":"2.9.1","device":"mps","cuda_available":false},"argv":["main.py","--mode","train","--data","fineweb_1b.npy","--result","decoupled"],"args":{"mode":"train","exp":"paper_decoupled","result":"decoupled","size":null,"layers":8,"data":"fineweb_1b.npy","ckpt":null,"out_dir":"runs/mps_1b_50m_l8_decoupled_s1337","resume":false,"resume_path":null,"resume_allow_config_mismatch":false,"no_selfopt":false,"run_tag":null,"seed":1337,"steps":-1,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"wandb":false,"wandb_project":"production","wandb_entity":null,"device_type":"mps","exp_source":"result","instrument":"rich","live_plot":false,"tb":false,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","dataset_tokens":1000000000,"dataset_tokens_source":"filename","tokens_per_param":20.0,"target_params":50000000,"target_params_source":"dataset_tokens/20","layers_source":"auto","tokenizer":"tiktoken","val_frac":0.1,"data_format":"auto","data_dtype":"int64","d_model":768,"n_head":6,"d_ff":3072,"embed_dim":768,"attn_mode":"decoupled","attn_dim":192,"sem_dim":60,"geo_dim":132,"kv_head":null,"rope_base":10000.0,"tie_qk":true,"null_attn":false,"no_rope":false,"no_decoupled_gate":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"block":1024,"optimizer":"adamw","weight_decay":0.1,"lr":0.000404784854302069,"min_lr":4.0478485430206903e-05,"lr_schedule":"cosine","warmup_steps":0,"adam_eps":1e-08,"adam_betas":"0.9,0.95","lion_betas":"0.9,0.99","opt_foreach":true,"opt_fused":false,"eval_iters":20,"eval_every":0,"save_every":0,"log_every":0,"_selfopt_summary":{"mode":"train","device_type":"mps","data":"fineweb_1b.npy","exp":"paper_decoupled","exp_source":"result","dataset_tokens":1000000000,"dataset_tokens_source":"filename","target_params":50000000,"target_params_source":"dataset_tokens/20","tokens_per_param":20.0,"layers":8,"layers_source":"auto","block":1024,"d_model":768,"n_head":6,"head_dim":128,"d_ff":3072,"embed_dim":768,"attn_mode":"decoupled","attn_dim":192,"sem_dim":60,"geo_dim":132,"rope":true,"tie_qk":true,"null_attn":false,"optimizer":"adamw","lr":0.000404784854302069,"weight_decay":0.1,"lr_schedule":"cosine","warmup_steps":0,"min_lr":4.0478485430206903e-05,"steps":-1,"out_dir":"runs/mps_1b_50m_l8_decoupled_s1337"},"vocab_size":50257,"param_dtype":"fp32","grad_checkpoint":false,"compile":false,"compile_mode":"reduce-overhead","amp":true,"amp_dtype":"bf16"},"config":{"vocab_size":50257,"block_size":1024,"n_layer":8,"n_head":6,"kv_head":null,"d_model":768,"d_ff":3072,"embed_dim":768,"attn_mode":"decoupled","attn_dim":192,"sem_dim":60,"geo_dim":132,"decoupled_gate":true,"rope":true,"rope_base":10000.0,"tie_qk":true,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-21T00:40:32+01:00"}
{"type":"train","step":1,"loss":10.9808349609375,"ppl":58737.5773882596,"lr":0.000404784854302069,"tok_s":9574.428615457035,"seq_len":1024,"gbs":4,"ms_step":427.8062080265954,"ms_fwd":43.095249915495515,"ms_bwd":126.42529106233269,"ms_opt":69.34641604311764,"mps_mem_alloc_bytes":1527987712.0,"mps_mem_driver_bytes":47860793344.0,"wall_time":"2025-12-21T00:41:02+01:00"}
{"type":"train","step":100,"loss":7.099873065948486,"ppl":1211.8132443648574,"lr":0.00040478470649493026,"tok_s":9208.518392824253,"seq_len":1024,"gbs":4,"ms_step":444.8055403996165,"ms_fwd":30.37413092320691,"ms_bwd":119.2149036655654,"ms_opt":72.72022897189464,"mps_mem_alloc_bytes":1540537856.0,"mps_mem_driver_bytes":39631568896.0,"wall_time":"2025-12-21T00:41:46+01:00"}
{"type":"train","step":200,"loss":6.733637809753418,"ppl":840.1981944273782,"lr":0.0004047842570866732,"tok_s":8559.051708243955,"seq_len":1024,"gbs":4,"ms_step":478.5576883540489,"ms_fwd":27.68025998957455,"ms_bwd":126.29333080956712,"ms_opt":79.5989775180351,"mps_mem_alloc_bytes":1540537856.0,"mps_mem_driver_bytes":39631568896.0,"wall_time":"2025-12-21T00:42:34+01:00"}
