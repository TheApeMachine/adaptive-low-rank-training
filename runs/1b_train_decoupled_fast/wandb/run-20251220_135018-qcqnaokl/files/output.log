[wandb] run: https://wandb.ai/p4n0p71c0n/experiments/runs/qcqnaokl
step 1/20000 loss=11.2322 ppl=75526.49 lr=5e-07 tok/s=413 seq=4096 gbs=1 ms/step=9923
step 100/20000 loss=7.8150 ppl=2477.44 lr=5e-05 tok/s=453 seq=4096 gbs=1 ms/step=9046
step 200/20000 loss=7.7721 ppl=2373.45 lr=0.0001 tok/s=446 seq=4096 gbs=1 ms/step=9192
[eval] step 200: train=7.2786 val=7.4637
step 300/20000 loss=7.0595 ppl=1163.91 lr=0.0001 tok/s=432 seq=4096 gbs=1 ms/step=9473
step 400/20000 loss=7.0898 ppl=1199.61 lr=0.0001 tok/s=438 seq=4096 gbs=1 ms/step=9343
[eval] step 400: train=7.0351 val=6.9904
Traceback (most recent call last):
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/main.py", line 16, in <module>
    raise SystemExit(main(sys.argv[1:]))
                     ^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/main.py", line 12, in main
    return run(args)
           ^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/production/cli.py", line 652, in run
    run_single(args, device)
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/production/runner.py", line 1086, in run_single
    logits, _ = model(xb)
                ^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/production/model.py", line 175, in forward
    x = checkpoint(_blk_fwd, x, use_reentrant=False)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/_compile.py", line 53, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 1044, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py", line 503, in checkpoint
    ret = function(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/production/model.py", line 172, in _blk_fwd
    y, _ = blk(x_in, attn_mask=attn_mask, cache=None, pos_offset=pos_offset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/production/model.py", line 92, in forward
    a, cache = self.attn(self.ln1(x), attn_mask=attn_mask, cache=cache, pos_offset=pos_offset)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/production/attention.py", line 1468, in forward
    out[:, :, t0:t1, :] = self._sdp(q_cat, k_cat, v_cat, attn_mask=None, scale=1.0)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/production/attention.py", line 548, in _sdp
    return F.scaled_dot_product_attention(q, k, v, attn_mask=attn_mask, dropout_p=dropout_p, is_causal=bool(is_causal))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/theapemachine/go/src/github.com/theapemachine/experiments/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py", line 1129, in pack_hook
    def pack_hook(x):

KeyboardInterrupt
