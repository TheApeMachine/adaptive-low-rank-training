{"type":"meta","step":0,"env":{"python":"3.12.12","torch":"2.9.1","device":"mps","cuda_available":false},"argv":["main.py","--mode","train","--size","1b","--exp","train_decoupled_fast","--data","fineweb_1b.npy","--wandb"],"args":{"expert":false,"no_selfopt":false,"size":"1b","exp":"train_decoupled_fast","run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_1b.npy","data_format":"auto","data_dtype":"uint16","vocab_size":null,"val_frac":0.1,"out_dir":"runs/1b_train_decoupled_fast","seed":1337,"device":null,"compile":true,"no_compile":false,"compile_mode":"reduce-overhead","amp":true,"no_amp":false,"amp_dtype":"bf16","param_dtype":"bf16","matmul_precision":"high","layers":18,"d_model":2048,"n_head":16,"d_ff":8192,"block":4096,"embed_dim":2048,"attn_mode":"decoupled","kv_head":null,"attn_dim":768,"sem_dim":256,"geo_dim":512,"no_decoupled_gate":false,"no_rope":false,"rope":false,"rope_base":10000.0,"tie_qk":true,"no_tie_qk":false,"null_attn":false,"no_null_attn":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":20000,"legacy_micro_steps":false,"batch_size":1,"grad_accum":1,"batch_by_seq":null,"batch_schedule":null,"train_seq_len":0,"seq_schedule":null,"eval_seq_len":0,"grad_checkpoint":true,"no_grad_checkpoint":false,"train_autotune":"off","train_autotune_gbs":64,"train_autotune_seq_lens":"512","train_autotune_batch_sizes":"8,16,24,32,48,64","train_autotune_warmup":0,"train_autotune_iters":1,"train_autotune_max_driver_gb":0.0,"optimizer":"lion","adam_betas":"0.9,0.95","adam_eps":1e-08,"lion_betas":"0.9,0.99","lr":0.0001,"lr_schedule":"cosine","warmup_steps":200,"min_lr":0.0,"opt_foreach":false,"opt_fused":false,"weight_decay":0.1,"grad_clip":1.0,"nan_policy":"reduce_lr","nan_lr_decay":0.5,"save_every":0,"eval_every":200,"eval_iters":20,"log_every":100,"instrument":"auto","analysis_every":100,"analysis_max_tokens":256,"analysis_layers":"0,-1","analysis_heads":"0","analysis_topk":8,"analysis_local_window":32,"analysis_save_scores":false,"live":"auto","live_update_every":1,"sync_timing":false,"live_plot":false,"tb":false,"wandb":true,"wandb_project":"experiments","wandb_entity":null,"wandb_name":null,"wandb_group":null,"wandb_tags":null,"wandb_mode":"disabled","mode":"train","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"draft_ckpt":null,"spec_k":4,"spec_method":"reject_sampling","spec_extra_token":false,"spec_disable_below_accept":0.0,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_policy":null,"kv_decode_block":1024,"kv_fused":"auto","self_opt":"none","self_opt_cache":null,"self_opt_decode_blocks":"256,512,1024,2048","self_opt_block_n":"128","self_opt_warps":"4,8","self_opt_stages":"2,3","self_opt_kernel_profiles":"auto","self_opt_expert_launch_space":false,"self_opt_warmup":1,"self_opt_iters":3,"self_opt_interval":256,"self_opt_hysteresis":0.03,"self_opt_verbose":false,"self_opt_verify":false,"self_opt_verify_tol":0.005,"self_opt_scope":"all","self_opt_residuals":"0,32,64,128","self_opt_qblocks":"16,32,64","self_opt_k_sem_kinds":"q4_0,nf4,q8_0,fp16","self_opt_k_geo_kinds":"q8_0,q4_0,fp16","self_opt_v_kinds":"q4_0,q8_0,fp16","self_opt_mem_budget_mb":null,"self_opt_mem_overhead_frac":0.1,"self_opt_policy_prefix_len":null,"self_opt_policy_warmup":1,"self_opt_policy_iters":3,"self_opt_policy_hysteresis":0.02,"self_opt_prefer_low_mem_within":0.02,"self_opt_policy_quality":false,"self_opt_calib_tokens":null,"self_opt_calib_prefill":128,"self_opt_calib_decode":32,"self_opt_quality_tol":0.5,"self_opt_quality_delta_nll_tol":0.02,"self_opt_quality_ppl_ratio_tol":1.02,"self_opt_quality_kl_tol":null,"self_opt_quality_kl":false,"self_opt_policy_quality_long":false,"self_opt_calib_long_tokens":null,"self_opt_calib_long_prefill":4096,"self_opt_calib_long_decode":128,"self_opt_quality_long_tol":null,"self_opt_quality_long_delta_nll_tol":null,"self_opt_quality_long_ppl_ratio_tol":null,"self_opt_quality_long_kl_tol":null,"self_opt_quality_long_kl":false,"self_opt_layerwise_cache":false,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null,"tokenizer":"word"},"config":{"vocab_size":50256,"block_size":4096,"n_layer":18,"n_head":16,"kv_head":null,"d_model":2048,"d_ff":8192,"embed_dim":2048,"attn_mode":"decoupled","attn_dim":768,"sem_dim":256,"geo_dim":512,"decoupled_gate":true,"rope":true,"rope_base":10000.0,"tie_qk":true,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-20T13:50:17+01:00"}
{"type":"train","step":1,"loss":11.23223876953125,"ppl":75526.49263619803,"lr":5e-07,"tok_s":412.7621068506769,"seq_len":4096,"gbs":1,"ms_step":9923.391542048194,"ms_fwd":3870.281957904808,"ms_bwd":5420.532959047705,"ms_opt":354.88816699944437,"mps_mem_alloc_bytes":7318513664.0,"mps_mem_driver_bytes":13776453632.0,"wall_time":"2025-12-20T13:50:30+01:00"}
{"type":"train","step":100,"loss":7.814981460571289,"ppl":2477.4410222466086,"lr":5e-05,"tok_s":452.8196232717937,"seq_len":4096,"gbs":1,"ms_step":9045.544383445322,"ms_fwd":3240.295029486379,"ms_bwd":5315.025578724512,"ms_opt":257.5875820787247,"mps_mem_alloc_bytes":7318546432.0,"mps_mem_driver_bytes":19254214656.0,"wall_time":"2025-12-20T14:05:26+01:00"}
{"type":"train","step":200,"loss":7.77209997177124,"ppl":2373.450237198186,"lr":0.0001,"tok_s":445.5817060523411,"seq_len":4096,"gbs":1,"ms_step":9192.477932473412,"ms_fwd":3300.2718037122395,"ms_bwd":5400.570243741386,"ms_opt":258.59438873361796,"mps_mem_alloc_bytes":7318546432.0,"mps_mem_driver_bytes":19254214656.0,"wall_time":"2025-12-20T14:20:45+01:00"}
{"type":"eval","step":200,"train_loss":7.278599905967712,"val_loss":7.463693594932556,"wall_time":"2025-12-20T14:22:49+01:00"}
{"type":"train","step":300,"loss":7.059539794921875,"ppl":1163.9094054835764,"lr":9.999383162408304e-05,"tok_s":432.3928953251275,"seq_len":4096,"gbs":1,"ms_step":9472.86609998555,"ms_fwd":3366.037902944954,"ms_bwd":5578.915972509421,"ms_opt":288.3995116665028,"mps_mem_alloc_bytes":7318513664.0,"mps_mem_driver_bytes":99860348928.0,"wall_time":"2025-12-20T14:38:39+01:00"}
{"type":"train","step":400,"loss":7.089754104614258,"ppl":1199.6127850923187,"lr":9.997507819778404e-05,"tok_s":438.393218245467,"seq_len":4096,"gbs":1,"ms_step":9343.210226638475,"ms_fwd":3311.1700966919307,"ms_bwd":5504.9457345483825,"ms_opt":287.93770286487415,"mps_mem_alloc_bytes":7318513664.0,"mps_mem_driver_bytes":99860348928.0,"wall_time":"2025-12-20T14:54:13+01:00"}
{"type":"eval","step":400,"train_loss":7.035134792327881,"val_loss":6.990447211265564,"wall_time":"2025-12-20T14:56:12+01:00"}
