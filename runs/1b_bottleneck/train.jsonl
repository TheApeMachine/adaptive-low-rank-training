{"type":"meta","step":0,"env":{"time":"2025-12-17T10:46:10+01:00","python":"3.12.12 (main, Oct  9 2025, 11:07:00) [Clang 17.0.0 (clang-1700.0.13.3)]","platform":"macOS-15.6-arm64-arm-64bit","torch":"2.9.1","device":"mps","triton_available":false},"argv":["v29_transformer_decoupled_bottleneck_instrumented.py","--mode","train","--device","mps","--data","fineweb_1b.npy","--data-format","npy","--out-dir","runs/1b_bottleneck","--d-model","768","--layers","12","--n-head","12","--d-ff","3072","--attn-dim","144","--sem-dim","48","--geo-dim","96","--param-dtype","bf16","--amp","--amp-dtype","bf16","--optimizer","lion","--batch-size","4","--grad-accum","4","--block","4096","--train-seq-len","1024","--seq-schedule","512@0,1024@5000,2048@15000,4096@25000","--steps","50000","--grad-checkpoint","--vocab-size","50257"],"args":{"size":null,"exp":null,"run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_1b.npy","data_format":"npy","data_dtype":"uint16","vocab_size":50257,"val_frac":0.1,"out_dir":"runs/1b_bottleneck","seed":1337,"device":"mps","compile":false,"compile_mode":"default","amp":true,"amp_dtype":"bf16","param_dtype":"bf16","matmul_precision":"high","layers":12,"d_model":768,"n_head":12,"d_ff":3072,"block":4096,"embed_dim":512,"attn_mode":"bottleneck","kv_head":null,"attn_dim":144,"sem_dim":48,"geo_dim":96,"no_rope":false,"rope":false,"rope_base":10000.0,"tie_qk":false,"no_tie_qk":false,"null_attn":false,"no_null_attn":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":50000,"batch_size":4,"grad_accum":4,"train_seq_len":1024,"seq_schedule":"512@0,1024@5000,2048@15000,4096@25000","eval_seq_len":0,"grad_checkpoint":true,"optimizer":"lion","adam_betas":"0.9,0.95","adam_eps":1e-08,"lion_betas":"0.9,0.99","lr":0.0003,"lr_schedule":"constant","warmup_steps":0,"min_lr":0.0,"opt_foreach":false,"opt_fused":false,"weight_decay":0.1,"grad_clip":1.0,"save_every":0,"eval_every":200,"eval_iters":20,"log_every":100,"instrument":"full","analysis_every":100,"analysis_max_tokens":256,"analysis_layers":"0,-1","analysis_heads":"0","analysis_topk":8,"analysis_local_window":32,"analysis_save_scores":false,"live":"auto","live_update_every":1,"sync_timing":false,"live_plot":false,"tb":false,"mode":"train","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","self_opt":"none","self_opt_cache":null,"self_opt_decode_blocks":"256,512,1024,2048","self_opt_block_n":"128","self_opt_warps":"4,8","self_opt_stages":"2,3","self_opt_warmup":1,"self_opt_iters":3,"self_opt_interval":256,"self_opt_hysteresis":0.03,"self_opt_verbose":false,"self_opt_verify":false,"self_opt_verify_tol":0.005,"self_opt_scope":"all","self_opt_residuals":"0,32,64,128","self_opt_qblocks":"16,32,64","self_opt_k_sem_kinds":"q4_0,nf4,q8_0,fp16","self_opt_k_geo_kinds":"q8_0,q4_0,fp16","self_opt_v_kinds":"q4_0,q8_0,fp16","self_opt_mem_budget_mb":null,"self_opt_mem_overhead_frac":0.1,"self_opt_policy_prefix_len":null,"self_opt_policy_warmup":1,"self_opt_policy_iters":3,"self_opt_policy_hysteresis":0.02,"self_opt_prefer_low_mem_within":0.02,"self_opt_policy_quality":false,"self_opt_calib_tokens":null,"self_opt_calib_prefill":128,"self_opt_calib_decode":32,"self_opt_quality_tol":0.5,"self_opt_quality_delta_nll_tol":0.02,"self_opt_quality_ppl_ratio_tol":1.02,"self_opt_quality_kl_tol":null,"self_opt_quality_kl":false,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null,"tokenizer":"word"},"config":{"vocab_size":50257,"block_size":4096,"n_layer":12,"n_head":12,"kv_head":null,"d_model":768,"d_ff":3072,"embed_dim":512,"attn_mode":"bottleneck","attn_dim":144,"sem_dim":48,"geo_dim":96,"rope":true,"rope_base":10000.0,"tie_qk":false,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-17T10:46:10+01:00"}
{"type":"mem","step":0,"kv_ctx_bytes":28311552,"kv_128k_bytes":884736000,"data_format":"npy","data_dtype":"uint16","n_tokens_total":1000000000,"n_tokens_train":900000000,"n_tokens_val":100000000,"vocab_size":50257,"wall_time":"2025-12-17T10:46:10+01:00"}
{"type":"eval","step":0,"train_loss":10.858671569824219,"val_loss":10.85379867553711,"val_ppl":51730.28516445687,"best_val":10.85379867553711,"wall_time":"2025-12-17T10:46:17+01:00"}
{"type":"train","step":1,"loss":9.751945495605469,"ppl":17187.63477109394,"lr":0.0003,"tok_s":6392.584646950882,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1281.484790961258,"data_ms":3.9550000219605863,"fwd_ms":350.8616250474006,"bwd_ms":764.3100420827977,"opt_ms":161.11183300381526,"grad_clip_norm":3.875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1614203904.0,"mps_mem_driver_bytes":5935136768.0,"cpu_rss_bytes":997097472.0,"grad_norm_embed":0.5774618869338365,"grad_norm_attn":0.5943918878534875,"grad_norm_ffn":0.5523920765859066,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9959422440493776,"wall_time":"2025-12-17T10:46:18+01:00"}
{"type":"analysis","step":100,"attn_entropy_mean":2.8278412222862244,"attn_topk_mass_mean":0.6265510618686676,"attn_local_mass_mean":0.4390915781259537,"attn_erank_mean":129.9056396484375,"proj_stable_rank_mean":24.179996910797534,"wall_time":"2025-12-17T10:47:55+01:00"}
{"type":"train","step":100,"loss":7.294181823730469,"ppl":1471.7122880993431,"lr":0.0003,"tok_s":8323.808117909937,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":984.1649259518211,"data_ms":3.7021725356221347,"fwd_ms":227.88413174890186,"bwd_ms":667.1096721024375,"opt_ms":83.97522214282718,"grad_clip_norm":3.203125,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1570435584.0,"mps_mem_driver_bytes":5568266240.0,"cpu_rss_bytes":1106444288.0,"grad_norm_embed":1.00106623739285,"grad_norm_attn":0.018952339131390064,"grad_norm_ffn":0.023598925726101744,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0015236952273547,"wall_time":"2025-12-17T10:47:55+01:00"}
{"type":"eval","step":200,"train_loss":7.493482398986816,"val_loss":7.524603271484375,"val_ppl":1853.0779113916644,"best_val":7.524603271484375,"wall_time":"2025-12-17T10:49:51+01:00"}
{"type":"analysis","step":200,"attn_entropy_mean":0.808945894241333,"attn_topk_mass_mean":0.9615973830223083,"attn_local_mass_mean":0.5765758156776428,"attn_erank_mean":115.53721237182617,"proj_stable_rank_mean":15.857535399015035,"wall_time":"2025-12-17T10:49:51+01:00"}
{"type":"train","step":200,"loss":4.4911346435546875,"ppl":89.22262434270046,"lr":0.0003,"tok_s":7324.737919441575,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1118.4017899475293,"data_ms":4.331771399592981,"fwd_ms":259.10438040969893,"bwd_ms":760.9812861692626,"opt_ms":92.4487508367747,"grad_clip_norm":3.671875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565471232.0,"mps_mem_driver_bytes":5618876416.0,"cpu_rss_bytes":1217593344.0,"grad_norm_embed":0.9951550394146097,"grad_norm_attn":0.02239142568853827,"grad_norm_ffn":0.016542861301560255,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9955443710235629,"wall_time":"2025-12-17T10:49:51+01:00"}
{"type":"analysis","step":300,"attn_entropy_mean":0.5569750368595123,"attn_topk_mass_mean":0.9922775328159332,"attn_local_mass_mean":0.6109668612480164,"attn_erank_mean":85.58496856689453,"proj_stable_rank_mean":14.316997620839922,"wall_time":"2025-12-17T10:51:43+01:00"}
{"type":"train","step":300,"loss":7.081395149230957,"ppl":1189.627068567489,"lr":0.0003,"tok_s":7309.736613436264,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1120.6970145739615,"data_ms":4.4300675560953096,"fwd_ms":258.00694171804935,"bwd_ms":764.507905698265,"opt_ms":92.18202622840181,"grad_clip_norm":2.609375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565422080.0,"mps_mem_driver_bytes":5568544768.0,"cpu_rss_bytes":1280032768.0,"grad_norm_embed":0.9963119278413188,"grad_norm_attn":0.046920791776092194,"grad_norm_ffn":0.020459475377206174,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9976259862255449,"wall_time":"2025-12-17T10:51:43+01:00"}
{"type":"eval","step":400,"train_loss":7.003705883026123,"val_loss":7.046498537063599,"val_ppl":1148.8291095473596,"best_val":7.046498537063599,"wall_time":"2025-12-17T10:53:33+01:00"}
{"type":"analysis","step":400,"attn_entropy_mean":0.4537329003214836,"attn_topk_mass_mean":0.9955560564994812,"attn_local_mass_mean":0.6829861998558044,"attn_erank_mean":90.00236511230469,"proj_stable_rank_mean":15.299076198689392,"wall_time":"2025-12-17T10:53:33+01:00"}
{"type":"train","step":400,"loss":7.287835121154785,"ppl":1462.4013460738647,"lr":0.0003,"tok_s":7670.598677687788,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1067.974006230943,"data_ms":4.2193629033863544,"fwd_ms":245.71120635373518,"bwd_ms":728.7668883870356,"opt_ms":87.961759098107,"grad_clip_norm":1.4140625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565053440.0,"mps_mem_driver_bytes":5618876416.0,"cpu_rss_bytes":1358020608.0,"grad_norm_embed":0.9940978383517002,"grad_norm_attn":0.05334883472125397,"grad_norm_ffn":0.027842535332957156,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9959175754827333,"wall_time":"2025-12-17T10:53:33+01:00"}
{"type":"analysis","step":500,"attn_entropy_mean":0.3999796137213707,"attn_topk_mass_mean":0.9982247948646545,"attn_local_mass_mean":0.6536130309104919,"attn_erank_mean":81.84280395507812,"proj_stable_rank_mean":12.894142820976345,"wall_time":"2025-12-17T10:55:14+01:00"}
{"type":"train","step":500,"loss":5.074700355529785,"ppl":159.92426437765076,"lr":0.0003,"tok_s":8112.191395272005,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1009.838106725947,"data_ms":4.145250331494026,"fwd_ms":232.09364124049898,"bwd_ms":689.7426349896705,"opt_ms":82.59017161093652,"grad_clip_norm":2.6875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565127168.0,"mps_mem_driver_bytes":5568544768.0,"cpu_rss_bytes":1422311424.0,"grad_norm_embed":0.997919750171658,"grad_norm_attn":0.033658940425011746,"grad_norm_ffn":0.01674226494753964,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9986275859842709,"wall_time":"2025-12-17T10:55:14+01:00"}
{"type":"eval","step":600,"train_loss":6.954689264297485,"val_loss":6.822261714935303,"val_ppl":918.0590516202051,"best_val":6.822261714935303,"wall_time":"2025-12-17T10:57:05+01:00"}
{"type":"analysis","step":600,"attn_entropy_mean":0.39711540192365646,"attn_topk_mass_mean":0.9979996085166931,"attn_local_mass_mean":0.6832512617111206,"attn_erank_mean":83.3944206237793,"proj_stable_rank_mean":11.957732461209622,"wall_time":"2025-12-17T10:57:05+01:00"}
{"type":"train","step":600,"loss":5.705644607543945,"ppl":300.5591603201583,"lr":0.0003,"tok_s":7582.897543374967,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1080.3258191398345,"data_ms":4.428863562643528,"fwd_ms":247.82889919530135,"bwd_ms":739.1970921016764,"opt_ms":87.70287087827455,"grad_clip_norm":2.3125,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565053440.0,"mps_mem_driver_bytes":5618876416.0,"cpu_rss_bytes":1493270528.0,"grad_norm_embed":0.9952245816268445,"grad_norm_attn":0.03527888399163296,"grad_norm_ffn":0.01800616373047123,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9960124444314495,"wall_time":"2025-12-17T10:57:05+01:00"}
{"type":"analysis","step":700,"attn_entropy_mean":0.39457838982343674,"attn_topk_mass_mean":0.9975714981555939,"attn_local_mass_mean":0.6486039906740189,"attn_erank_mean":95.59891128540039,"proj_stable_rank_mean":13.65975040947867,"wall_time":"2025-12-17T10:58:50+01:00"}
{"type":"train","step":700,"loss":6.104375839233398,"ppl":447.8130468738434,"lr":0.0003,"tok_s":7752.820165579533,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1056.6477520490298,"data_ms":4.366762090940028,"fwd_ms":245.53022414329462,"bwd_ms":713.0250703572528,"opt_ms":91.91311671223957,"grad_clip_norm":1.28125,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565127168.0,"mps_mem_driver_bytes":5568544768.0,"cpu_rss_bytes":1557430272.0,"grad_norm_embed":0.9796439939364888,"grad_norm_attn":0.17907135312556938,"grad_norm_ffn":0.03325984823775093,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9964311927428086,"wall_time":"2025-12-17T10:58:50+01:00"}
{"type":"eval","step":800,"train_loss":6.5293766260147095,"val_loss":6.56547532081604,"val_ppl":710.1493647632283,"best_val":6.56547532081604,"wall_time":"2025-12-17T11:00:32+01:00"}
{"type":"analysis","step":800,"attn_entropy_mean":0.36164262145757675,"attn_topk_mass_mean":0.9984812140464783,"attn_local_mass_mean":0.6462581157684326,"attn_erank_mean":91.77362442016602,"proj_stable_rank_mean":12.108392901132254,"wall_time":"2025-12-17T11:00:32+01:00"}
{"type":"train","step":800,"loss":6.402223110198975,"ppl":603.1844940416565,"lr":0.0003,"tok_s":8259.19977090796,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":991.8636462645372,"data_ms":3.554795833188109,"fwd_ms":236.46630627044942,"bwd_ms":659.6618137374753,"opt_ms":89.4822762417607,"grad_clip_norm":0.6328125,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565053440.0,"mps_mem_driver_bytes":5618876416.0,"cpu_rss_bytes":1628471296.0,"grad_norm_embed":0.6242084606652583,"grad_norm_attn":0.09416752023368584,"grad_norm_ffn":0.030585113368815142,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.6320120041524814,"wall_time":"2025-12-17T11:00:32+01:00"}
{"type":"analysis","step":900,"attn_entropy_mean":0.35118408501148224,"attn_topk_mass_mean":0.9991266131401062,"attn_local_mass_mean":0.6609902083873749,"attn_erank_mean":86.66646003723145,"proj_stable_rank_mean":12.96483237402876,"wall_time":"2025-12-17T11:02:18+01:00"}
{"type":"train","step":900,"loss":6.133166790008545,"ppl":460.8934046982003,"lr":0.0003,"tok_s":7783.420216323037,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1052.493604652118,"data_ms":4.066103084478527,"fwd_ms":248.59962450631429,"bwd_ms":704.2358709225664,"opt_ms":93.21181294275448,"grad_clip_norm":2.46875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565127168.0,"mps_mem_driver_bytes":5568544768.0,"cpu_rss_bytes":1690828800.0,"grad_norm_embed":0.9965428551592854,"grad_norm_attn":0.04017371820753499,"grad_norm_ffn":0.01768663358977298,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9975091011170665,"wall_time":"2025-12-17T11:02:18+01:00"}
{"type":"eval","step":1000,"train_loss":6.522312045097351,"val_loss":6.50172529220581,"val_ppl":666.2901872305038,"best_val":6.50172529220581,"wall_time":"2025-12-17T11:04:01+01:00"}
{"type":"analysis","step":1000,"attn_entropy_mean":0.30740299820899963,"attn_topk_mass_mean":0.9991555511951447,"attn_local_mass_mean":0.6325414031744003,"attn_erank_mean":90.41953086853027,"proj_stable_rank_mean":12.75408710407298,"wall_time":"2025-12-17T11:04:01+01:00"}
{"type":"train","step":1000,"loss":6.59812593460083,"ppl":733.7188628483731,"lr":0.0003,"tok_s":8193.317365090354,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":999.8392146878177,"data_ms":3.549578321981244,"fwd_ms":236.82120831334032,"bwd_ms":666.8315978016471,"opt_ms":90.32832838012837,"grad_clip_norm":1.3359375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565053440.0,"mps_mem_driver_bytes":5618876416.0,"cpu_rss_bytes":1760477184.0,"grad_norm_embed":0.997311685948169,"grad_norm_attn":0.09509762311619284,"grad_norm_ffn":0.044674735868627,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.0028309871937844,"wall_time":"2025-12-17T11:04:01+01:00"}
{"type":"analysis","step":1100,"attn_entropy_mean":0.3186852037906647,"attn_topk_mass_mean":0.9994244277477264,"attn_local_mass_mean":0.680851012468338,"attn_erank_mean":87.34328269958496,"proj_stable_rank_mean":12.156569349000003,"wall_time":"2025-12-17T11:05:40+01:00"}
{"type":"train","step":1100,"loss":5.658679008483887,"ppl":286.76957206494944,"lr":0.0003,"tok_s":8276.052182489877,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":989.8439279216109,"data_ms":3.6119341454468668,"fwd_ms":233.84501895867288,"bwd_ms":661.091844161856,"opt_ms":88.97174203186296,"grad_clip_norm":3.359375,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565127168.0,"mps_mem_driver_bytes":5568544768.0,"cpu_rss_bytes":1821966336.0,"grad_norm_embed":0.996004142818356,"grad_norm_attn":0.047807976118089686,"grad_norm_ffn":0.02938102384141204,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9975836304058951,"wall_time":"2025-12-17T11:05:40+01:00"}
{"type":"eval","step":1200,"train_loss":6.512074279785156,"val_loss":6.425519967079163,"val_ppl":617.4017626863719,"best_val":6.425519967079163,"wall_time":"2025-12-17T11:07:23+01:00"}
{"type":"analysis","step":1200,"attn_entropy_mean":0.2633771002292633,"attn_topk_mass_mean":0.9995703399181366,"attn_local_mass_mean":0.6384368985891342,"attn_erank_mean":80.40435409545898,"proj_stable_rank_mean":12.257491592749382,"wall_time":"2025-12-17T11:07:23+01:00"}
{"type":"train","step":1200,"loss":6.47825813293457,"ppl":650.8362880510264,"lr":0.0003,"tok_s":8192.58496790587,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":999.9285978835542,"data_ms":3.6974918242776766,"fwd_ms":235.9586868842598,"bwd_ms":667.6189236843493,"opt_ms":90.185608775937,"grad_clip_norm":1.765625,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565053440.0,"mps_mem_driver_bytes":5618876416.0,"cpu_rss_bytes":1885601792.0,"grad_norm_embed":0.9937124969284504,"grad_norm_attn":0.07689458463679415,"grad_norm_ffn":0.03430525370992879,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9972733597817317,"wall_time":"2025-12-17T11:07:23+01:00"}
{"type":"analysis","step":1300,"attn_entropy_mean":0.2854302227497101,"attn_topk_mass_mean":0.9994508624076843,"attn_local_mass_mean":0.660000741481781,"attn_erank_mean":90.88122177124023,"proj_stable_rank_mean":12.53466465390216,"wall_time":"2025-12-17T11:09:03+01:00"}
{"type":"train","step":1300,"loss":6.793102264404297,"ppl":891.6754886305249,"lr":0.0003,"tok_s":8154.67899001703,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":1004.5766375388486,"data_ms":4.017145180841908,"fwd_ms":235.33403969253413,"bwd_ms":676.2212811777135,"opt_ms":87.33536202285904,"grad_clip_norm":1.796875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565127168.0,"mps_mem_driver_bytes":5568544768.0,"cpu_rss_bytes":1946730496.0,"grad_norm_embed":0.9907542992601182,"grad_norm_attn":0.0827363082648274,"grad_norm_ffn":0.03948548523151737,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":0.9949866741578345,"wall_time":"2025-12-17T11:09:03+01:00"}
{"type":"eval","step":1400,"train_loss":6.5599202632904055,"val_loss":6.575536227226257,"val_ppl":717.3301732091315,"best_val":6.425519967079163,"wall_time":"2025-12-17T11:10:44+01:00"}
{"type":"analysis","step":1400,"attn_entropy_mean":0.2547249346971512,"attn_topk_mass_mean":0.9997135698795319,"attn_local_mass_mean":0.6795792877674103,"attn_erank_mean":75.58815002441406,"proj_stable_rank_mean":12.921983672703496,"wall_time":"2025-12-17T11:10:44+01:00"}
{"type":"train","step":1400,"loss":3.533109664916992,"ppl":34.230246880483065,"lr":0.0003,"tok_s":8356.597161244845,"seq_len":512,"grad_accum":4,"global_batch":16,"step_ms":980.3033270518063,"data_ms":3.5546938056359068,"fwd_ms":231.34838744997978,"bwd_ms":656.9305441662436,"opt_ms":86.57447292585857,"grad_clip_norm":2.6875,"opt_state_bytes":233599264,"mps_mem_alloc_bytes":1565053440.0,"mps_mem_driver_bytes":5618876416.0,"cpu_rss_bytes":2012037120.0,"grad_norm_embed":0.9997704471087453,"grad_norm_attn":0.04807940481500881,"grad_norm_ffn":0.032112028013294366,"grad_norm_attn_sem":0.0,"grad_norm_attn_geo":0.0,"grad_norm_total":1.001440841199575,"wall_time":"2025-12-17T11:10:44+01:00"}
