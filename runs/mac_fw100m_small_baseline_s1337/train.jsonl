{"type":"meta","step":0,"env":{"python":"3.12.12","torch":"2.9.1","device":"mps","cuda_available":false},"argv":["main.py","--mode","train","--size","small","--exp","paper_baseline","--data","fineweb_100m.npy","--out-dir","runs/mac_fw100m_small_baseline_s1337","--seed","1337","--steps","50000","--eval-every","1000","--eval-iters","20","--save-every","2000","--instrument","full","--tokenizer","tiktoken","--block","1024","--wandb","--wandb-name","mac_fw100m_small_baseline_s1337","--wandb-project","production","--wandb-entity","p4n0p71c0n","--wandb-group","mac_fw100m"],"args":{"no_selfopt":false,"mode":"train","size":"small","exp":"paper_baseline","run_root":"runs","run_tag":null,"print_config":false,"data":"fineweb_100m.npy","data_format":"auto","data_dtype":"uint16","vocab_size":null,"val_frac":0.1,"out_dir":"runs/mac_fw100m_small_baseline_s1337","resume":false,"resume_path":null,"resume_allow_config_mismatch":false,"seed":1337,"device":null,"tokenizer":"tiktoken","ckpt":null,"prompt_tokens":"0","max_new_tokens":50,"temperature":1.0,"top_k":null,"instrument":"full","tb":false,"wandb":true,"wandb_project":"production","wandb_entity":"p4n0p71c0n","wandb_name":"mac_fw100m_small_baseline_s1337","wandb_group":"mac_fw100m","wandb_tags":null,"wandb_mode":"disabled","live_plot":false,"layers":12,"d_model":768,"n_head":12,"d_ff":3072,"block":1024,"embed_dim":768,"attn_mode":"standard","kv_head":null,"attn_dim":512,"sem_dim":32,"geo_dim":64,"no_decoupled_gate":false,"no_rope":false,"rope_base":10000.0,"tie_qk":false,"null_attn":false,"no_learned_temp":false,"mlp":"swiglu","dropout":0.0,"steps":50000,"train_seq_len":0,"eval_seq_len":0,"log_every":50,"eval_every":1000,"eval_iters":20,"save_every":2000,"seq_schedule":null,"legacy_micro_steps":false,"batch_size":8,"grad_accum":1,"batch_by_seq":null,"batch_schedule":null,"grad_checkpoint":false,"optimizer":"adamw","adam_betas":"0.9,0.95","adam_eps":1e-08,"lion_betas":"0.9,0.99","lr":0.0003,"lr_schedule":"constant","warmup_steps":0,"min_lr":0.0,"weight_decay":0.1,"grad_clip":1.0,"nan_policy":"reduce_lr","nan_lr_decay":0.5,"sync_timing":false,"compile":false,"compile_mode":"reduce-overhead","amp":true,"amp_dtype":"bf16","param_dtype":"fp32","matmul_precision":"high","opt_foreach":true,"opt_fused":false,"draft_ckpt":null,"kv_cache":"fp16","kv_qblock":32,"kv_residual":128,"kv_decode_block":1024,"kv_fused":"auto","kv_policy":null,"kv_cache_k":null,"kv_cache_v":null,"kv_cache_k_sem":null,"kv_cache_k_geo":null,"kv_qblock_k":null,"kv_qblock_v":null,"kv_qblock_k_sem":null,"kv_qblock_k_geo":null},"config":{"vocab_size":50257,"block_size":1024,"n_layer":12,"n_head":12,"kv_head":null,"d_model":768,"d_ff":3072,"embed_dim":768,"attn_mode":"standard","attn_dim":512,"sem_dim":32,"geo_dim":64,"decoupled_gate":true,"rope":true,"rope_base":10000.0,"tie_qk":false,"null_attn":false,"learned_temp":true,"mlp":"swiglu","dropout":0.0},"wall_time":"2025-12-20T21:50:13+01:00"}
{"type":"train","step":1,"loss":10.977577209472656,"ppl":58546.53631061589,"lr":0.0003,"tok_s":6240.748373526236,"seq_len":1024,"gbs":8,"ms_step":1312.6630829647183,"ms_fwd":290.276916930452,"ms_bwd":406.5660419873893,"ms_opt":404.5399589231238,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":21128036352.0,"wall_time":"2025-12-20T21:50:31+01:00"}
{"type":"train","step":50,"loss":7.515956878662109,"ppl":1837.1245407835859,"lr":0.0003,"tok_s":6385.810906944131,"seq_len":1024,"gbs":8,"ms_step":1282.8441241646794,"ms_fwd":291.53681465909267,"ms_bwd":407.0365246342571,"ms_opt":350.9630128071282,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T21:51:34+01:00"}
{"type":"train","step":100,"loss":7.268309593200684,"ppl":1434.1241496808311,"lr":0.0003,"tok_s":6339.322591727545,"seq_len":1024,"gbs":8,"ms_step":1292.2516375314444,"ms_fwd":292.81982003943995,"ms_bwd":411.791495825164,"ms_opt":352.993927472271,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T21:52:39+01:00"}
{"type":"train","step":150,"loss":6.745296001434326,"ppl":850.0507056698004,"lr":0.0003,"tok_s":5670.255791640692,"seq_len":1024,"gbs":8,"ms_step":1444.732001698576,"ms_fwd":326.18259001756087,"ms_bwd":455.7818359322846,"ms_opt":405.63817671034485,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T21:53:51+01:00"}
{"type":"train","step":200,"loss":6.4663801193237305,"ppl":643.1513768563545,"lr":0.0003,"tok_s":4989.4498058915715,"seq_len":1024,"gbs":8,"ms_step":1641.8643976189196,"ms_fwd":356.39340840512887,"ms_bwd":508.01348256878555,"ms_opt":499.3017924623564,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T21:55:13+01:00"}
{"type":"train","step":250,"loss":6.59420919418335,"ppl":730.8506971201783,"lr":0.0003,"tok_s":5489.3208092490495,"seq_len":1024,"gbs":8,"ms_step":1492.3522025160491,"ms_fwd":333.02690837997943,"ms_bwd":474.1582966619171,"ms_opt":420.38959906902164,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T21:56:28+01:00"}
{"type":"train","step":300,"loss":6.499831199645996,"ppl":665.0293663768344,"lr":0.0003,"tok_s":5499.077630589698,"seq_len":1024,"gbs":8,"ms_step":1489.7043741354719,"ms_fwd":333.57285662088543,"ms_bwd":470.68118422292173,"ms_opt":421.1965025542304,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T21:57:42+01:00"}
{"type":"train","step":350,"loss":6.429040431976318,"ppl":619.5791343508052,"lr":0.0003,"tok_s":5092.91066273782,"seq_len":1024,"gbs":8,"ms_step":1608.5104456939735,"ms_fwd":350.4133341740817,"ms_bwd":500.22613753797486,"ms_opt":485.7191858300939,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T21:59:03+01:00"}
{"type":"train","step":400,"loss":6.649560928344727,"ppl":772.4450923214619,"lr":0.0003,"tok_s":5318.06471725035,"seq_len":1024,"gbs":8,"ms_step":1540.4099866305478,"ms_fwd":337.3784341639839,"ms_bwd":478.4846799890511,"ms_opt":461.0836017038673,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:00:20+01:00"}
{"type":"train","step":450,"loss":6.317476272583008,"ppl":554.1726454485325,"lr":0.0003,"tok_s":5381.475448600754,"seq_len":1024,"gbs":8,"ms_step":1522.2591050062329,"ms_fwd":332.1721841976978,"ms_bwd":472.5149858254008,"ms_opt":458.51858586538583,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:01:36+01:00"}
{"type":"train","step":500,"loss":6.1556715965271,"ppl":471.38331557548327,"lr":0.0003,"tok_s":5290.11206197263,"seq_len":1024,"gbs":8,"ms_step":1548.5494265588932,"ms_fwd":337.4916533823125,"ms_bwd":482.2176275518723,"ms_opt":465.8192157931626,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:02:53+01:00"}
{"type":"train","step":550,"loss":6.042760372161865,"ppl":421.05369712401466,"lr":0.0003,"tok_s":5170.467562981632,"seq_len":1024,"gbs":8,"ms_step":1584.3828242248856,"ms_fwd":342.4801958561875,"ms_bwd":489.8985883849673,"ms_opt":485.3955017030239,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:04:13+01:00"}
{"type":"train","step":600,"loss":6.135188579559326,"ppl":461.826176784536,"lr":0.0003,"tok_s":5429.692185156456,"seq_len":1024,"gbs":8,"ms_step":1508.7411441840231,"ms_fwd":336.8863966851495,"ms_bwd":475.91621078085154,"ms_opt":431.07761677354574,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:05:28+01:00"}
{"type":"train","step":650,"loss":6.1401190757751465,"ppl":464.1088316879835,"lr":0.0003,"tok_s":5047.836678729495,"seq_len":1024,"gbs":8,"ms_step":1622.873425069265,"ms_fwd":356.01900663459674,"ms_bwd":505.79191837692633,"ms_opt":483.86949006235227,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:06:49+01:00"}
{"type":"train","step":700,"loss":5.844263076782227,"ppl":345.248026726787,"lr":0.0003,"tok_s":5241.052686904398,"seq_len":1024,"gbs":8,"ms_step":1563.0447716102935,"ms_fwd":345.68949157372117,"ms_bwd":488.570154896006,"ms_opt":460.4466550052166,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:08:07+01:00"}
{"type":"train","step":750,"loss":5.972772598266602,"ppl":392.59266489668016,"lr":0.0003,"tok_s":5182.316800755365,"seq_len":1024,"gbs":8,"ms_step":1580.7601725170389,"ms_fwd":341.9685999583453,"ms_bwd":486.5869725192897,"ms_opt":488.5924533754587,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:09:27+01:00"}
{"type":"train","step":800,"loss":5.837159156799316,"ppl":342.80410336650584,"lr":0.0003,"tok_s":5553.428394439101,"seq_len":1024,"gbs":8,"ms_step":1475.1248090644367,"ms_fwd":328.91603582538664,"ms_bwd":461.66724825277925,"ms_opt":428.21303922683,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:10:40+01:00"}
{"type":"train","step":850,"loss":5.884572505950928,"ppl":359.44907280748623,"lr":0.0003,"tok_s":5682.66639192345,"seq_len":1024,"gbs":8,"ms_step":1441.5767942392267,"ms_fwd":319.91327916970477,"ms_bwd":449.9820650089532,"ms_opt":420.63039909815416,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:11:52+01:00"}
{"type":"train","step":900,"loss":5.944971084594727,"ppl":381.82832041741216,"lr":0.0003,"tok_s":6019.338289383351,"seq_len":1024,"gbs":8,"ms_step":1360.946935720276,"ms_fwd":306.54691161587834,"ms_bwd":430.647387499921,"ms_opt":380.1700176135637,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:13:00+01:00"}
{"type":"train","step":950,"loss":5.717219352722168,"ppl":304.05826758339884,"lr":0.0003,"tok_s":5937.166858736555,"seq_len":1024,"gbs":8,"ms_step":1379.782680007629,"ms_fwd":312.48409336199984,"ms_bwd":437.6475392142311,"ms_opt":382.6618232554756,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:14:10+01:00"}
{"type":"train","step":1000,"loss":5.618124008178711,"ppl":275.3723021798173,"lr":0.0003,"tok_s":6049.862509362817,"seq_len":1024,"gbs":8,"ms_step":1354.0803592349403,"ms_fwd":305.23089500144124,"ms_bwd":428.16257999744266,"ms_opt":377.11593908956274,"mps_mem_alloc_bytes":2473395456.0,"mps_mem_driver_bytes":22778494976.0,"wall_time":"2025-12-20T22:15:17+01:00"}
{"type":"eval","step":1000,"train_loss":5.7272919654846195,"val_loss":5.699543619155884,"wall_time":"2025-12-20T22:15:40+01:00"}
{"type":"train","step":1050,"loss":5.794204235076904,"ppl":328.3907581325957,"lr":0.0003,"tok_s":6033.0004683895,"seq_len":1024,"gbs":8,"ms_step":1357.8649699967355,"ms_fwd":306.3217925815843,"ms_bwd":429.07759838271886,"ms_opt":378.8078691647388,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:16:48+01:00"}
{"type":"train","step":1100,"loss":5.7152581214904785,"ppl":303.46252339976763,"lr":0.0003,"tok_s":6021.919043091801,"seq_len":1024,"gbs":8,"ms_step":1360.3636882826686,"ms_fwd":306.2054249527864,"ms_bwd":429.94628578191623,"ms_opt":380.48769081942737,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:17:56+01:00"}
{"type":"train","step":1150,"loss":5.701986789703369,"ppl":299.4617778974399,"lr":0.0003,"tok_s":5874.241495735406,"seq_len":1024,"gbs":8,"ms_step":1394.5630267239176,"ms_fwd":314.6570699568838,"ms_bwd":440.15620671678334,"ms_opt":389.8578199534677,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:19:06+01:00"}
{"type":"train","step":1200,"loss":5.692241668701172,"ppl":296.55766010892563,"lr":0.0003,"tok_s":5792.280427813919,"seq_len":1024,"gbs":8,"ms_step":1414.296165748965,"ms_fwd":321.80189174832776,"ms_bwd":448.0271742818877,"ms_opt":389.1976716602221,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:20:17+01:00"}
{"type":"train","step":1250,"loss":5.597529888153076,"ppl":269.759248271534,"lr":0.0003,"tok_s":5501.652185479585,"seq_len":1024,"gbs":8,"ms_step":1489.0072516072541,"ms_fwd":335.60884666163474,"ms_bwd":470.79542907653376,"ms_opt":418.5789083596319,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:21:31+01:00"}
{"type":"train","step":1300,"loss":5.429210186004639,"ppl":227.96912109865707,"lr":0.0003,"tok_s":4994.573276560728,"seq_len":1024,"gbs":8,"ms_step":1640.180160824675,"ms_fwd":367.298289174214,"ms_bwd":514.5784491137601,"ms_opt":473.7334766378626,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:22:53+01:00"}
{"type":"train","step":1350,"loss":5.663273811340332,"ppl":288.09025352574776,"lr":0.0003,"tok_s":5295.227221180471,"seq_len":1024,"gbs":8,"ms_step":1547.0535366702825,"ms_fwd":350.4738890635781,"ms_bwd":489.91978825535625,"ms_opt":433.34099581930786,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:24:11+01:00"}
{"type":"train","step":1400,"loss":5.637148857116699,"ppl":280.661370969551,"lr":0.0003,"tok_s":5348.077942592368,"seq_len":1024,"gbs":8,"ms_step":1531.7652599560097,"ms_fwd":336.03459337260574,"ms_bwd":475.50549486652017,"ms_opt":460.29019674053416,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:25:27+01:00"}
{"type":"train","step":1450,"loss":5.426518440246582,"ppl":227.35631131804473,"lr":0.0003,"tok_s":5442.573920808665,"seq_len":1024,"gbs":8,"ms_step":1505.1701858709566,"ms_fwd":329.4744649063796,"ms_bwd":466.26842418685555,"ms_opt":453.1415400002152,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:26:43+01:00"}
{"type":"train","step":1500,"loss":5.5824809074401855,"ppl":265.7300403250604,"lr":0.0003,"tok_s":5440.766902023024,"seq_len":1024,"gbs":8,"ms_step":1505.670091647189,"ms_fwd":327.8140991786495,"ms_bwd":466.7662690556608,"ms_opt":454.7274499689229,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:27:58+01:00"}
{"type":"train","step":1550,"loss":5.420443534851074,"ppl":225.979329986106,"lr":0.0003,"tok_s":5699.297788780485,"seq_len":1024,"gbs":8,"ms_step":1437.3700591898523,"ms_fwd":319.22241588355973,"ms_bwd":449.4229117059149,"ms_opt":417.1019324543886,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:29:10+01:00"}
{"type":"train","step":1600,"loss":5.592087745666504,"ppl":268.2951674869517,"lr":0.0003,"tok_s":6065.920229205609,"seq_len":1024,"gbs":8,"ms_step":1350.4958341782913,"ms_fwd":305.021849127952,"ms_bwd":426.1905174772255,"ms_opt":376.4623791608028,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:30:17+01:00"}
{"type":"train","step":1650,"loss":5.605715274810791,"ppl":271.97639374044985,"lr":0.0003,"tok_s":6185.518421074332,"seq_len":1024,"gbs":8,"ms_step":1324.383736711461,"ms_fwd":299.02935008052737,"ms_bwd":417.8099716012366,"ms_opt":369.0810032677837,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:31:24+01:00"}
{"type":"train","step":1700,"loss":5.495502948760986,"ppl":243.59401066221997,"lr":0.0003,"tok_s":6056.56069149629,"seq_len":1024,"gbs":8,"ms_step":1352.5828299717978,"ms_fwd":305.53623834159225,"ms_bwd":426.2414932483807,"ms_opt":378.5524290939793,"mps_mem_alloc_bytes":2472641792.0,"mps_mem_driver_bytes":36770693120.0,"wall_time":"2025-12-20T22:32:31+01:00"}
